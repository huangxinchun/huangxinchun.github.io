---
layout:     post                    # 使用的布局（不需要改）
title:      http总结              # 标题
subtitle:   坚持坚持再坚持      #副标题
date:       2020-04-13              # 时间
author:     hxc                      # 作者
header-img:    #这篇文章标题背景图片
catalog: true                       # 是否归档
categories: 
tags:                               #标签
    - http
---
# 我的http整理

<!-- GFM-TOC -->
* [一 、基础概念](#一-基础概念)
    * [URI](#uri)
    * [请求和响应报文](#请求和响应报文)
* [二、HTTP 方法](#二http-方法)
    * [GET](#get)
    * [HEAD](#head)
    * [POST](#post)
    * [PUT](#put)
    * [PATCH](#patch)
    * [DELETE](#delete)
    * [OPTIONS](#options)
    * [CONNECT](#connect)
    * [TRACE](#trace)
* [三、HTTP 状态码](#三http-状态码)
    * [1XX 信息](#1xx-信息)
    * [2XX 成功](#2xx-成功)
    * [3XX 重定向](#3xx-重定向)
    * [4XX 客户端错误](#4xx-客户端错误)
    * [5XX 服务器错误](#5xx-服务器错误)
* [四、HTTP 首部](#四http-首部)
    * [通用首部字段](#通用首部字段)
    * [请求首部字段](#请求首部字段)
    * [响应首部字段](#响应首部字段)
    * [实体首部字段](#实体首部字段)
* [五、具体应用](#五具体应用)
    * [连接管理](#连接管理)
    * [Cookie](#cookie)
    * [缓存](#缓存)
    * [内容协商](#内容协商)
    * [内容编码](#内容编码)
    * [范围请求](#范围请求)
    * [分块传输编码](#分块传输编码)
    * [多部分对象集合](#多部分对象集合)
    * [虚拟主机](#虚拟主机)
    * [通信数据转发](#通信数据转发)
* [六、HTTPS](#六https)
    * [加密](#加密)
    * [认证](#认证)
    * [完整性保护](#完整性保护)
    * [HTTPS 的缺点](#https-的缺点)
* [七、HTTP/2.0](#七http20)
    * [HTTP/1.x 缺陷](#http1x-缺陷)
    * [二进制分帧层](#二进制分帧层)
    * [服务端推送](#服务端推送)
    * [首部压缩](#首部压缩)
* [八、HTTP/1.1 新特性](#八http11-新特性)
* [九、GET 和 POST 比较](#九get-和-post-比较)
    * [作用](#作用)
    * [参数](#参数)
    * [安全](#安全)
    * [幂等性](#幂等性)
    * [可缓存](#可缓存)
    * [XMLHttpRequest](#xmlhttprequest)
* [参考资料](#参考资料)
<!-- GFM-TOC -->

# 1 基础概念

>- 1.HTTP协议，即超文本传输协议(Hypertext transfer protocol)。是一种详细规定了浏览器和万维网(WWW = World Wide Web)服务器之间互相通信的规则，通过因特网传送万维网文档的数据传送协议。
>- 2.HTTP协议作为TCP/IP模型中应用层的协议也不例外。HTTP协议通常承载于TCP协议之上，有时也承载于TLS或SSL协议层之上，这个时候，就成了我们常说的HTTPS。如下图：
>- 3.HTTP是一个应用层协议，由请求和响应构成，是一个标准的客户端服务器模型。HTTP是一个无状态的协议。
>- 4.HTTP默认的端口号为80，HTTPS的端口号为443。
>- 5.浏览网页是HTTP的主要应用，但是这并不代表HTTP就只能应用于网页的浏览。HTTP是一种协议，只要通信的双方都遵守这个协议，HTTP就能有用武之地。比如咱们常用的QQ，迅雷这些软件，都会使用HTTP协议(还包括其他的协议)。
          
# 2 工作原理

HTTP协议定义Web客户端如何从Web服务器请求Web页面，以及服务器如何把Web页面传送给客户端。HTTP协议采用了请求/响应模型。客户端向服务器发送一个请求报文，请求报文包含请求的方法、URL、协议版本、请求头部和请求数据。服务器以一个状态行作为响应，响应的内容包括协议的版本、成功或者错误代码、服务器信息、响应头部和响应数据。

以下是 HTTP 请求/响应的步骤：

>- 1、客户端连接到Web服务器
一个HTTP客户端，通常是浏览器，与Web服务器的HTTP端口（默认为80）建立一个TCP套接字连接。例如，huangxinchun.github.io。

>- 2、发送HTTP请求
通过TCP套接字，客户端向Web服务器发送一个文本的请求报文，一个请求报文由请求行、请求头部、空行和请求数据4部分组成。

>- 3、服务器接受请求并返回HTTP响应
Web服务器解析请求，定位请求资源。服务器将资源复本写到TCP套接字，由客户端读取。一个响应由状态行、响应头部、空行和响应数据4部分组成。

>- 4、释放连接TCP连接
若connection 模式为close，则服务器主动关闭TCP连接，客户端被动关闭连接，释放TCP连接;若connection 模式为keepalive，则该连接会保持一段时间，在该时间内可以继续接收请求;

>- 5、客户端浏览器解析HTML内容
客户端浏览器首先解析状态行，查看表明请求是否成功的状态代码。然后解析每一个响应头，响应头告知以下为若干字节的HTML文档和文档的字符集。客户端浏览器读取响应数据HTML，根据HTML的语法对其进行格式化，并在浏览器窗口中显示。

# 3 请求和响应报文

## 3.1 请求报文

客户端发送一个HTTP请求到服务器的请求消息包括以下格式：

**请求行**、**请求头**、**空行**和**请求数据**四个部分组成。
- 请求体结构
![图片](https://huangxinchun.github.io/HxcBlog/images/imagesHttp/http_01.png)

>- 第一部分：请求行，用来说明请求类型,要访问的资源以及所使用的HTTP版本.
GET说明请求类型为GET,/doc/test.html为要访问的资源，该行的最后一部分说明使用的是HTTP1.1版本。
>- 第二部分：请求头部，紧接着请求行（即第一行）之后的部分，用来说明服务器要使用的附加信息
从第二行起为请求头部，HOST将指出请求的目的地. User-Agent,服务器端和客户端脚本都能访问它,它是浏览器类型检测逻辑的重要基础.该信息由你的浏览器来定义,并且在每个请求中自动发送等等
>- 第三部分：空行，请求头部后面的空行是必须的
即使第四部分的请求数据为空，也必须有空行。
>- 第四部分：请求数据也叫主体，可以添加任意的其他数据。


## 3.2 响应报文

一般情况下，服务器接收并处理客户端发过来的请求后会返回一个HTTP的响应消息。

HTTP响应也由四个部分组成，分别是：**状态行**、**消息报头**、**空行**和**响应正文**。

![图片](https://huangxinchun.github.io/HxcBlog/images/imagesHttp/http_02.png)

>- 第一部分：状态行，由HTTP协议版本号， 状态码， 状态消息 三部分组成。
第一行为状态行，（HTTP/1.1）表明HTTP版本为1.1版本，状态码为200，状态消息为（ok）
>- 第二部分：消息报头，用来说明客户端要使用的一些附加信息
第二行和第三行和第四行为消息报头，
Date:生成响应的日期和时间；Content-Type:指定了MIME类型的HTML(text/html),编码类型是ISO-8859-1
>- 第三部分：空行，消息报头后面的空行是必须的
>- 第四部分：响应正文，服务器返回给客户端的文本信息。
空行后面的html部分为响应正文。

# 4 HTTP方法

## 4.1 常用方法

- GET（SELECT）：从服务器取出资源（一项或多项）, 当前网络请求中，绝大部分使用的是 GET 方法。

- POST（CREATE）：在服务器新建一个资源, POST 主要用来传输数据，而 GET 主要用来获取资源。。

- PUT（UPDATE）：在服务器更新资源（客户端提供改变后的完整资源）。

- PATCH（UPDATE）：在服务器更新资源（客户端提供改变的属性）, PATCH 允许部分修改。

- DELETE（DELETE）：从服务器删除资源。

## 4.2 典型RESTful API例子

# 5 HTTP 状态码

>服务器返回的**响应报文**中第一行为状态行，包含了状态码以及原因短语，用来告知客户端请求的结果。


| 状态码 | 类别 | 含义 |
| :---: | :---: | :---: |
| 1XX | Informational（信息性状态码） | 接收的请求正在处理 |
| 2XX | Success（成功状态码） | 请求正常处理完毕 |
| 3XX | Redirection（重定向状态码） | 需要进行附加操作以完成请求 |
| 4XX | Client Error（客户端错误状态码） | 服务器无法处理请求 |
| 5XX | Server Error（服务器错误状态码） | 服务器处理请求出错 |

## 5.1 (1XX)信息状态码
   
   - 100 Continue ：表明到目前为止都很正常，客户端可以继续发送请求或者忽略这个响应。

## 5.2 (2XX)成功状态码

   - **200 OK** ：请求成功
   - **204 No Content** ：请求已经成功处理，但是返回的响应报文不包含实体的主体部分。一般在只需要从客户端往服务器发送信息，而不需要返回数据时使用。     
   - **206 Partial Content** ：表示客户端进行了范围请求，响应报文包含由 Content-Range 指定范围的实体内容。
   
## 5.3 (3XX)重定向状态码
   
   - **301 Moved Permanently** ：永久性重定向
   - **302 Found** ：临时性重定向
   - **303 See Other** ：和 302 有着相同的功能，但是 303 明确要求客户端应该采用 GET 方法获取资源。
       - 注：虽然 HTTP 协议规定 301、302 状态下重定向时不允许把 POST 方法改成 GET 方法，但是大多数浏览器都会在 301、302 和 303 状态下的重定向把 POST 方法改成 GET 方法。
   - **304 Not Modified** ：如果请求报文首部包含一些条件，例如：If-Match，If-Modified-Since，If-None-Match，If-Range，If-Unmodified-Since，如果不满足条件，则服务器会返回 304 状态码。
   - **307 Temporary Redirect** ：临时重定向，与 302 的含义类似，但是 307 要求浏览器不会把重定向请求的 POST 方法改成 GET 方法。
   
## 5.4 (4XX)客户端错误状态码
    
   - **400 Bad Request** ：请求报文中存在语法错误。
   - **401 Unauthorized** ：该状态码表示发送的请求需要有认证信息（BASIC 认证、DIGEST 认证）。如果之前已进行过一次请求，则表示用户认证失败。
   - **403 Forbidden** ：请求被拒绝。
   - **404 Not Found** ：页面不存在。
   
## 5.5 (5XX)服务器错误状态码
    
   - **500 Internal Server Error** ：服务器正在执行请求时发生错误。
   - **503 Service Unavailable** ：服务器暂时处于超负载或正在进行停机维护，现在无法处理请求。

# 6 HTTP消息报头

> 消息报头分为通用报头、请求报头、响应报头、实体报头等。消息报头由键值对组成，每行一对，关键字和值用英文冒号“：”分隔。

## 6.1 通用报头
    
它既可以出现在请求报头，也可以出现在响应报头中，如下所示：

   - **Date**：表示消息产生的日期和时间。
   - **Connection**：允许发送指定连接的选项。例如指定连接是连续的；或者指定“close”选项，通知服务 器，在响应完成后，关闭连接。
   - **Cache-Control**：用于指定缓存指令，缓存指令是单向的（响应中出现的缓存指令在请求中未必会出现），且是独立的（一个消息的缓存指令不会影响另一个消息处理的缓存机制）。

## 6.2 请求报头

在请求行之后会有0个或者多个请求报头，请求报头通知服务器关于客户端请求的信息。典型的请求报头如下所示:

   - **Host**：请求的主机名，允许多个域名同处一个IP地址，即虚拟主机。
   
   - **User-Agent**：发送请求的浏览器类型、操作系统等信息。
   
   - **Accept**：客户端可识别的内容类型列表，用于指定客户端接收哪些类型的信息。
   
   - **Accept-Charset**：请求报头域用于指定客户端接受的字符集 。
   
   - **Accept-Encoding**：客户端可识别的数据编码。
   
   - **Accept-Language**：表示浏览器所支持的语言类型。
   
   - **Authorization**：请求报头域主要用于证明客户端有权查看某个资源。
   
   - **Connection**：允许客户端和服务器指定与请求/响应连接有关的选项。例如，这时为Keep-Alive则表示 保持连接。
   
   - **Transfer-Encoding**：告知接收端为了保证报文的可靠传输，对报文采用了什么编码方式。 
    
## 6.3 响应报头

用于服务器传递自身信息的响应。常见的响应报头如下所示:

   - **Location**：用于重定向接收者到一个新的位置，常用在更换域名的时候。
   
   - **Server**：包含服务器用来处理请求的系统信息，与User-Agent请求报头是相对应的。
   
## 6.4 实体报头

实体报头用来定义被传送资源的信息，其既可用于请求也可用于响应。请求和响应消息都可以传送一 个实体。常见的实体报头如下所示:

   - **Content-Type**：发送给接收者的实体正文的媒体类型。
   
   - **Content-Lenght**：实体正文的长度。
   
   - **Content-Language**：描述资源所用的自然语言。
   
   - **Content-Encoding**：实体报头被用作媒体类型的修饰符。它的值指示了已经被应用到实体正文的附加 内容的编码，因而要获得Content-Type报头域中所引用的媒体类型，必须采用相应的解码机制。
   
   - **Last-Modified**：实体报头用于指示资源的最后修改日期和时间。
   
   - **Expires**：实体报头给出响应过期的日期和时间。



